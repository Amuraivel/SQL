SELECT docdb_family_id, publn_auth as jurisdiction,publn_nr, appln_filing_date, max(prs_gazette_date) as registry_event_date, prs_code as patent_death_code, max(DATEDIFF(prs_gazette_date,appln_filing_date)) AS max_days_alive

FROM ((INPADOC JOIN tls211_pat_publn USING (appln_id)) 
JOIN TLS218_DOCDB_FAM USING (appln_id))
JOIN tls201_appln USING (appln_id)

WHERE 
-- Get the families
docdb_family_id IN (3479167) -- 3479918,39884997,48779259



AND 
-- kill codes by country
-- nested kill code for the EP patents
concat(appln_auth,concat(prs_code,l501ep,l502ep)) IN (
'ARFA',
'ARFC',
'ARFD',
'ATAZ',
'ATA1AW',
'ATA1J',
'ATA1V',
'ATA1Z',
'ATEDES',
'ATEEGN',
'ATEELA',
'ATEELV',
'ATEEN',
'ATEGA',
'ATELJ',
'ATELV',
'ATEN',
'ATMM9K',
'ATMN9K',
'ATREN',
'ATRER',
'ATREZ',
'ATRH',
'ATRZN',
'AUCFC',
'AUCLAC',
'AUMAK',
'AUMAL',
'AUMAY',
'AUMFS',
'AUMK1',
'AUMK10',
'AUMK12',
'AUMK14',
'AUMK15',
'AUMK16',
'AUMK17',
'AUMK18',
'AUMK19',
'AUMK20',
'AUMK21',
'AUMK22',
'AUMK23',
'AUMK24',
'AUMK25',
'AUMK3',
'AUMK4',
'AUMK5',
'AUMK6',
'AUMK7',
'AUMK8',
'AUMK9',
'AUROP',
'BEERE',
'BEE20',
'BERE',
'BERE20',
'BRB07G',
'BRB08F',
'BRB08K',
'BRB09B',
'BRB09R',
'BRB10A',
'BRB10G',
'BRB11A',
'BRB11B',
'BRB11E',
'BRB11F',
'BRB11K',
'BRB11L',
'BRB11Q',
'BRB11Y',
'BRB11Z',
'BRB13B',
'BRB14F',
'BRB16D',
'BRB17A',
'BRB18A',
'BRB21A',
'BRB21B',
'BRB23G',
'BRB23R',
'BRB24C',
'BRFA',
'BRFA1',
'BRFA10',
'BRFA11',
'BRFA12',
'BRFA13',
'BRFA14',
'BRFA15',
'BRFA2',
'BRFA3',
'BRFA4',
'BRFA5',
'BRFA6',
'BRFA7',
'BRFA8',
'BRFA9',
'BRFC',
'BRFD5',
'BRHHFA',
'BRHHFN',
'BRHHN',
'BRHIFF',
'BRHKFA',
'BRHKFN',
'BRHNA',
'BRMC',
'BRMD',
'BRME',
'BRMFC',
'BRMS',
'BRMT',
'BRTKX1',
'CAAZWI',
'CAMKEX',
'CAMKLA',
'CAMZSU',
'CHAZW',
'CHPL',
'CHPLVZ',
'CHPZW',
'CHPZZ',
'CL162',
'CNC02',
'CNC04',
'CNC12',
'CNC17',
'CNC19',
'CNC20',
'CNC25',
'CNC28',
'CNC35',
'COFA',
'COFC',
'COFD',
'CSMC4A',
'CSMK4A',
'CSMM4A',
'CUFD',
'CUMK',
'CZMA4A',
'CZMC3K',
'CZMC4A',
'CZMH1K',
'CZMK1K',
'CZMK4A',
'CZMM4A',
'DDEN',
'DDENJ',
'DDWP12',
'DDZN',
'DDZW',
'DDZWAA',
'DDZWAB',
'DDZWAC',
'DDZWAH',
'DDZZAA',
'DDZZAB',
'DDZZAC',
'DDZZAH',
'DEBHN',
'DEBHV',
'DEEHE',
'DEEHJ',
'DEEHN',
'DEEHV',
'DEEHZ',
'DEEIN',
'DEEINU',
'DEOHN',
'DEOHW',
'DER001',
'DER002',
'DER003',
'DER005',
'DER064',
'DER071',
'DER108',
'DER118',
'DER119',
'DER120',
'DER123',
'DER132',
'DER135',
'DER142',
'DER156',
'DER157',
'DER158',
'DER165',
'DER168',
'DER231',
'DER424',
'DE8130',
'DE8131',
'DE8133',
'DE8136',
'DE8139',
'DE8140',
'DE8141',
'DE8143',
'DE8230',
'DE8311',
'DE8330',
'DE8331',
'DE8332',
'DE8333',
'DE8339',
'DE8340',
'DE8506',
'DE8566',
'DKAHB',
'DKAHS',
'DKARF',
'DKATS',
'DKEAP',
'DKEDV',
'DKEUG',
'DKEUP',
'DKPBP',
'DKPRF',
'DKPSP',
'DKPTS',
'DKPUG',
'DKPUP',
'DKUBP',
'DKUDV',
'DKUHB',
'DKURA',
'DKURF',
'DKUTS',
'DKUUP',
'DKUYT',
'EAFA9A',
'EAMC4A',
'EAMF4A',
'EAMM4A',
'EEMA4A',
'EEMM4A',
'EPAKY',
'EPD18D',
'EPD18Z',
'EPGBAW',
'EPPG25',
'EP18D',
'EP18R',
'EP18W',
'EP27W',
'ESFA1K',
'ESFA2A',
'ESFC1K',
'ESFC2A',
'ESFD1A',
'ESFD1K',
'ESFD2A',
'ESMC1A',
'ESMC1K',
'ESMC2A',
'ESMH1A',
'ESMH1K',
'ESMM1K',
'ESMM4A',
'ESRL2A',
'FICD',
'FIFA',
'FIFAU',
'FIFC',
'FIFCU',
'FIFD',
'FIFDU',
'FIMA',
'FIMAU',
'FIMF',
'FIMFD',
'FIMFDR',
'FIMFU',
'FIMFX',
'FIMH',
'FIMM',
'FIMMU',
'FRDE',
'FRD3',
'FRD5',
'FRD7',
'FRMT',
'FRRR',
'FRRS',
'FRRT',
'FRST',
'GBAT',
'GBGBPC',
'GBGBPR',
'GBGBV',
'GBPCNP',
'GBPE',
'GBPE20',
'GBPLNP',
'GBPR',
'GBRJ',
'GBS29',
'GBS73',
'GBWAP',
'GB728R',
'GB7281',
'GB7282',
'GB729C',
'GB729S',
'GB729U',
'GB772B',
'GB772E',
'GB772K',
'GB772L',
'GB772M',
'GB772R',
'GB772S',
'GB772X',
'GB773K',
'GB773L',
'GB773M',
'GB775E',
'HKAD',
'HKAF1',
'HKAR',
'HKARR',
'HKAW',
'HKNR',
'HKPC',
'HKPE',
'HKPEU',
'HKPF1',
'HKPF2',
'HKPR',
'HKPS',
'HKREV',
'HKWD',
'HUBFA1',
'HUBFA9',
'HUBFC4',
'HUBFC9',
'HUBFD9',
'HUDFA1',
'HUDFA9',
'HUDFC4',
'HUDFC9',
'HUDFD9',
'HUDMA4',
'HUDMC4',
'HUDMH4',
'HUDMK4',
'HUDMM4',
'HUFA9A',
'HUFC4A',
'HUFD9A',
'HUHFA1',
'HUHFA9',
'HUHFC9',
'HUHFD9',
'HUHMA4',
'HUHMC4',
'HUHMH4',
'HUHMK4',
'HUHMM4',
'HUMH4A',
'HUMM4A',
'IECA39',
'IEFA9A',
'IEFA9B',
'IEFC9A',
'IEFD4D',
'IEFD4E',
'IEFI9A',
'IEFJ9A',
'IEFK9A',
'IEMA39',
'IEMK9A',
'IEMM4A',
'IEMM9A',
'IENMA',
'IENW37',
'ILCE',
'ILEXP',
'ILME',
'ILMF',
'ILMFD',
'ILMM9K',
'ILRH',
'ILRH1',
'JPAA91',
'JPAA92',
'JPA02',
'JPA045',
'JPA072',
'JPA131',
'JPA313',
'JPA761',
'JPA762',
'JPR155',
'JPS801',
'LTFD9A',
'LTMA9A',
'LTMC9A',
'LTMG4D',
'LTMG9A',
'LTMG9D',
'LTMK9A',
'LTMM4D',
'LTMM9A',
'LTLTLA',
'MDCD4A',
'MDCD4K',
'MDFA1A',
'MDFA2A',
'MDFA9A',
'MDFA9K',
'MDFC2A',
'MDFC9A',
'MDFC9K',
'MDKA4A',
'MDKA4K',
'MDMB4A',
'MDMB4K',
'MDMC4A',
'MDMM3A',
'MDMM4A',
'MDMM4K',
'MD1M4A',
'NLBI',
'NLBV',
'NLEDI',
'NLRD2W',
'NLR2B',
'NLVAF',
'NLVAFA',
'NLVDEP',
'NLVD1',
'NLVD2',
'NLVD3',
'NLVD4',
'NLVIT',
'NLVITA',
'NLVJC',
'NLV1',
'NLV2',
'NLV3',
'NLV4',
'NLV5',
'NLV6',
'NLWDAP',
'NLXEP',
'NOEPNV',
'NOFC2A',
'NOMC2A',
'NOMH4A',
'NOMINV',
'NOMK1K',
'NOMMEP',
'NOMM1K',
'NORE',
'NZAABA',
'NZAVOD',
'NZEXPY',
'NZS42R',
'NZS43',
'NZS43R',
'PEFA',
'PEFC',
'PEFD',
'PEFX',
'PLDISC',
'PLDISD',
'PLDISU',
'PLLAPE',
'PLLAPU',
'PLREFS',
'PLREFU',
'PLVDSO',
'PLVOID',
'PLVOIU',
'PTFA1A',
'PTFA1K',
'PTFC3A',
'PTFC3K',
'PTFC4A',
'PTMA3A',
'PTMA3K',
'PTMA4A',
'PTMF4A',
'PTMM3A',
'PTMM3K',
'PTMM4A',
'PTMM4K',
'PTMP4A',
'RUFA9A',
'RUFA91',
'RUFA92',
'RUFA93',
'RUFA94',
'RUFA95',
'RUMF1K',
'RUMF11',
'RUMF4A',
'RUMF41',
'RUMG1K',
'RUMG11',
'RUMG4A',
'RUMM1K',
'RUMM4A',
'RUMZ1K',
'RUMZ4A',
'SECANC',
'SEECNC',
'SEEUG',
'SENAV',
'SENUG',
'SEREJA',
'SER40A',
'SEWITD',
'SIKO00',
'SINC00',
'SKFA9A',
'SKFB9A',
'SKFC9A',
'SKMC4A',
'SKMK4A',
'SKMM4A',
'TWMA4A',
'TWMA4K',
'TWMC4A',
'TWMC4K',
'TWMK4A',
'TWMK4K',
'TWMM4A',
'TWMM4K',
'USDJ',
'USDJB',
'USFP',
'USFPB1',
'USFPB2',
'USFPB3',
'USLAPS',
'USWDB1',
'USWDR',
'REGATATAZ',
'REGATATA1AW',
'REGATATA1J',
'REGATATA1V',
'REGATATA1Z',
'REGATATEDES',
'REGATATEEGN',
'REGATATEELA',
'REGATATEELV',
'REGATATEEN',
'REGATATEGA',
'REGATATELJ',
'REGATATELV',
'REGATATEN',
'REGATATMM9K',
'REGATATMN9K',
'REGATATREN',
'REGATATRER',
'REGATATREZ',
'REGATATRH',
'REGATATRZN',
'REGBEBEERE',
'REGBEBEE20',
'REGBEBERE',
'REGBEBERE20',
'REGCHCHAZW',
'REGCHCHPL',
'REGCHCHPLVZ',
'REGCHCHPZW',
'REGCHCHPZZ',
'REGCZCZMA4A',
'REGCZCZMC3K',
'REGCZCZMC4A',
'REGCZCZMH1K',
'REGCZCZMK1K',
'REGCZCZMK4A',
'REGCZCZMM4A',
'REGDEDEBHN',
'REGDEDEBHV',
'REGDEDEEHE',
'REGDEDEEHJ',
'REGDEDEEHN',
'REGDEDEEHV',
'REGDEDEEHZ',
'REGDEDEEIN',
'REGDEDEEINU',
'REGDEDEOHN',
'REGDEDEOHW',
'REGDEDER001',
'REGDEDER002',
'REGDEDER003',
'REGDEDER005',
'REGDEDER064',
'REGDEDER071',
'REGDEDER108',
'REGDEDER118',
'REGDEDER119',
'REGDEDER120',
'REGDEDER123',
'REGDEDER132',
'REGDEDER135',
'REGDEDER142',
'REGDEDER156',
'REGDEDER157',
'REGDEDER158',
'REGDEDER165',
'REGDEDER168',
'REGDEDER231',
'REGDEDER424',
'REGDEDE8130',
'REGDEDE8131',
'REGDEDE8133',
'REGDEDE8136',
'REGDEDE8139',
'REGDEDE8140',
'REGDEDE8141',
'REGDEDE8143',
'REGDEDE8230',
'REGDEDE8311',
'REGDEDE8330',
'REGDEDE8331',
'REGDEDE8332',
'REGDEDE8333',
'REGDEDE8339',
'REGDEDE8340',
'REGDEDE8506',
'REGDEDE8566',
'REGDKDKAHB',
'REGDKDKAHS',
'REGDKDKARF',
'REGDKDKATS',
'REGDKDKEAP',
'REGDKDKEDV',
'REGDKDKEUG',
'REGDKDKEUP',
'REGDKDKPBP',
'REGDKDKPRF',
'REGDKDKPSP',
'REGDKDKPTS',
'REGDKDKPUG',
'REGDKDKPUP',
'REGDKDKUBP',
'REGDKDKUDV',
'REGDKDKUHB',
'REGDKDKURA',
'REGDKDKURF',
'REGDKDKUTS',
'REGDKDKUUP',
'REGDKDKUYT',
'REGEEEEMA4A',
'REGEEEEMM4A',
'REGESESFA1K',
'REGESESFA2A',
'REGESESFC1K',
'REGESESFC2A',
'REGESESFD1A',
'REGESESFD1K',
'REGESESFD2A',
'REGESESMC1A',
'REGESESMC1K',
'REGESESMC2A',
'REGESESMH1A',
'REGESESMH1K',
'REGESESMM1K',
'REGESESMM4A',
'REGESESRL2A',
'REGFIFICD',
'REGFIFIFA',
'REGFIFIFAU',
'REGFIFIFC',
'REGFIFIFCU',
'REGFIFIFD',
'REGFIFIFDU',
'REGFIFIMA',
'REGFIFIMAU',
'REGFIFIMF',
'REGFIFIMFD',
'REGFIFIMFDR',
'REGFIFIMFU',
'REGFIFIMFX',
'REGFIFIMH',
'REGFIFIMM',
'REGFIFIMMU',
'REGFRFRDE',
'REGFRFRD3',
'REGFRFRD5',
'REGFRFRD7',
'REGFRFRMT',
'REGFRFRRR',
'REGFRFRRS',
'REGFRFRRT',
'REGFRFRST',
'REGGBGBAT',
'REGGBGBGBPC',
'REGGBGBGBPR',
'REGGBGBGBV',
'REGGBGBPCNP',
'REGGBGBPE',
'REGGBGBPE20',
'REGGBGBPLNP',
'REGGBGBPR',
'REGGBGBRJ',
'REGGBGBS29',
'REGGBGBS73',
'REGGBGBWAP',
'REGGBGB728R',
'REGGBGB7281',
'REGGBGB7282',
'REGGBGB729C',
'REGGBGB729S',
'REGGBGB729U',
'REGGBGB772B',
'REGGBGB772E',
'REGGBGB772K',
'REGGBGB772L',
'REGGBGB772M',
'REGGBGB772R',
'REGGBGB772S',
'REGGBGB772X',
'REGGBGB773K',
'REGGBGB773L',
'REGGBGB773M',
'REGGBGB775E',
'REGHUHUBFA1',
'REGHUHUBFA9',
'REGHUHUBFC4',
'REGHUHUBFC9',
'REGHUHUBFD9',
'REGHUHUDFA1',
'REGHUHUDFA9',
'REGHUHUDFC4',
'REGHUHUDFC9',
'REGHUHUDFD9',
'REGHUHUDMA4',
'REGHUHUDMC4',
'REGHUHUDMH4',
'REGHUHUDMK4',
'REGHUHUDMM4',
'REGHUHUFA9A',
'REGHUHUFC4A',
'REGHUHUFD9A',
'REGHUHUHFA1',
'REGHUHUHFA9',
'REGHUHUHFC9',
'REGHUHUHFD9',
'REGHUHUHMA4',
'REGHUHUHMC4',
'REGHUHUHMH4',
'REGHUHUHMK4',
'REGHUHUHMM4',
'REGHUHUMH4A',
'REGHUHUMM4A',
'REGIEIECA39',
'REGIEIEFA9A',
'REGIEIEFA9B',
'REGIEIEFC9A',
'REGIEIEFD4D',
'REGIEIEFD4E',
'REGIEIEFI9A',
'REGIEIEFJ9A',
'REGIEIEFK9A',
'REGIEIEMA39',
'REGIEIEMK9A',
'REGIEIEMM4A',
'REGIEIEMM9A',
'REGIEIENMA',
'REGIEIENW37',
'REGLTLTFD9A',
'REGLTLTMA9A',
'REGLTLTMC9A',
'REGLTLTMG4D',
'REGLTLTMG9A',
'REGLTLTMG9D',
'REGLTLTMK9A',
'REGLTLTMM4D',
'REGLTLTMM9A',
'REGLTLTLTLA',
'REGNLNLBI',
'REGNLNLBV',
'REGNLNLEDI',
'REGNLNLRD2W',
'REGNLNLR2B',
'REGNLNLVAF',
'REGNLNLVAFA',
'REGNLNLVDEP',
'REGNLNLVD1',
'REGNLNLVD2',
'REGNLNLVD3',
'REGNLNLVD4',
'REGNLNLVIT',
'REGNLNLVITA',
'REGNLNLVJC',
'REGNLNLV1',
'REGNLNLV2',
'REGNLNLV3',
'REGNLNLV4',
'REGNLNLV5',
'REGNLNLV6',
'REGNLNLWDAP',
'REGNLNLXEP',
'REGNONOEPNV',
'REGNONOFC2A',
'REGNONOMC2A',
'REGNONOMH4A',
'REGNONOMINV',
'REGNONOMK1K',
'REGNONOMMEP',
'REGNONOMM1K',
'REGNONORE',
'REGPLPLDISC',
'REGPLPLDISD',
'REGPLPLDISU',
'REGPLPLLAPE',
'REGPLPLLAPU',
'REGPLPLREFS',
'REGPLPLREFU',
'REGPLPLVDSO',
'REGPLPLVOID',
'REGPLPLVOIU',
'REGPTPTFA1A',
'REGPTPTFA1K',
'REGPTPTFC3A',
'REGPTPTFC3K',
'REGPTPTFC4A',
'REGPTPTMA3A',
'REGPTPTMA3K',
'REGPTPTMA4A',
'REGPTPTMF4A',
'REGPTPTMM3A',
'REGPTPTMM3K',
'REGPTPTMM4A',
'REGPTPTMM4K',
'REGPTPTMP4A',
'REGSESECANC',
'REGSESEECNC',
'REGSESEEUG',
'REGSESENAV',
'REGSESENUG',
'REGSESEREJA',
'REGSESER40A',
'REGSESEWITD',
'REGSISIKO00',
'REGSISINC00',
'REGSKSKFA9A',
'REGSKSKFB9A',
'REGSKSKFC9A',
'REGSKSKMC4A',
'REGSKSKMK4A',
'REGSKSKMM4A'
)

GROUP BY concat(docdb_family_id,appln_auth,l501ep)

LIMIT 1000


